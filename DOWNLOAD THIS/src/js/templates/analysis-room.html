<div id="analysis-room" class="w-full max-w-screen-2xl mx-auto flex-col lg:flex-row items-stretch justify-center gap-4 hidden lg:h-screen p-4">
    <div class="flex justify-center items-center">
        <main class="w-full flex flex-col gap-2">
            <header class="header-footer p-3 rounded-lg flex justify-between items-center text-light">
                <div class="flex items-center gap-3">
                    <img src="assets/icon/bug.png" class="w-8 h-8">
                    <div>
                        <div class="font-bold">Game Review</div>
                        <div id="ar-player-names" class="text-sm text-dark">Player vs Computer</div>
                    </div>
                </div>
                <button id="return-to-game-btn" class="top-action-icon-btn" title="Exit Review"><img src="assets/icon/x-mark.png" class="w-6 h-6"></button>
            </header>

            <div class="board-wrapper">
                <div id="analysis-top-files" class="coordinates files"></div>
                <div id="analysis-left-ranks" class="coordinates ranks"></div>
                <div id="analysis-board" class="w-full aspect-square"></div>
                <svg id="analysis-board-svg-overlay" class="board-svg-overlay"></svg>
                <div id="analysis-right-ranks" class="coordinates ranks"></div>
                <div id="analysis-bottom-files" class="coordinates files"></div>
            </div>

            <footer class="header-footer p-3 rounded-lg text-light bg-inset">
                <div id="ar-move-assessment-details" class="hidden">
                     <div id="ar-assessment-title" class="text-lg font-bold flex items-center"></div>
                     <p id="ar-assessment-comment" class="text-sm text-dark mt-1"></p>
                </div>
                <div id="ar-best-line-display" class="hidden mt-2">
                    <span class="text-sm font-bold text-accent">Best Line:</span>
                    <span id="ar-best-line-moves" class="font-mono ml-2"></span>
                </div>
                <button id="ar-retry-mistake-btn" class="hidden btn-primary w-full mt-3 py-2">Retry this move</button>
            </footer>
        </main>
    </div>
    <aside class="w-full lg:w-1/3 xl:w-2/5 flex-shrink-0 flex flex-col gap-4">
        <details id="review-summary-container" class="summary-panel" open>
            <summary class="summary-panel-title">Review Summary</summary>
            <div id="analysis-dashboard">
                <div class="dashboard-grid">
                    <div class="dashboard-item text-center">
                        <div class="label">White Accuracy</div>
                        <div id="ar-white-accuracy" class="value">--%</div>
                        <div class="accuracy-bar-container"><div id="ar-white-accuracy-bar" class="accuracy-bar"></div></div>
                    </div>
                    <div class="dashboard-item text-center">
                        <div class="label">Black Accuracy</div>
                        <div id="ar-black-accuracy" class="value">--%</div>
                        <div class="accuracy-bar-container"><div id="ar-black-accuracy-bar" class="accuracy-bar"></div></div>
                    </div>
                </div>
                <div id="ar-move-counts" class="grid grid-cols-2 gap-x-4"></div>
            </div>
        </details>
        <details id="estimated-elo-panel" class="summary-panel" open>
            <summary class="summary-panel-title">Estimated ELO</summary>
            <div class="dashboard-grid">
                <div class="dashboard-item text-center"><div class="elo-badge">White: <span id="ar-white-elo">----</span></div></div>
                <div class="dashboard-item text-center"><div class="elo-badge">Black: <span id="ar-black-elo">----</span></div></div>
            </div>
        </details>
        <details id="game-phase-panel" class="summary-panel">
            <summary class="summary-panel-title">Game Phase Performance</summary>
            <div id="ar-phase-display" class="space-y-2"></div>
        </details>
        <div class="flex-grow flex flex-col min-h-0 bg-inset rounded-lg p-4">
            <div class="flex justify-between items-center mb-2">
                <h3 class="text-xl font-bold">Moves</h3>
                <div id="key-moments-toggle-container" class="key-moments-toggle-group hidden">
                    <button data-filter="all" class="key-moments-toggle active">All Moves</button>
                    <button data-filter="key" class="key-moments-toggle">Key Moments</button>
                </div>
            </div>
            <div id="ar-analysis-move-list" class="flex-grow overflow-y-auto pr-2"></div>
        </div>
        <div id="eval-chart-container" class="summary-panel h-40">
            <canvas id="ar-eval-chart"></canvas>
        </div>
    </aside>
</div>